

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Device Data and Configuration &mdash; Bifravst v10.4.8 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="LED schema" href="LEDSchema.html" />
    <link rel="prev" title="Device-Cloud-Protocol" href="Protocol.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../README.html">
          

          
            
            <img src="../../_static/logo-with-text-white.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v10.4.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../aws/Index.html">Bifravst on AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/Index.html">Bifravst on Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app/Index.html">Cat Tracker Web Application</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Index.html">Cat Tracker firmware</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Overview.html">Functional Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPrebuildImages.html">Using pre-build images</a></li>
<li class="toctree-l2"><a class="reference internal" href="Configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="BuildingUsingDocker.html">Building using Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="BuildingUsingLocalSystem.html">Building using your local system</a></li>
<li class="toctree-l2"><a class="reference internal" href="BuildingUsingGitHub.html">Building using GitHub actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aws/FirmwareContinuousIntegration.html">Continuous Integration of Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="Protocol.html">Device-Cloud-Protocol</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Device Data and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="LEDSchema.html">LED schema</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../devices/Index.html">Connect using a real device</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/AutomateHEXFileBuilding.html">Automate building of HEX files for your nRF Connect SDK application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/CellGeolocations.html">Cell Geolocations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/Cloud-connectivity-and-protocols-for-the-Internet-of-Things.html">Cloud connectivity and protocols for the Internet of Things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/CloudDifferences.html">Cloud Differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ETSI-EN-303-645.html">Cyber Security for Consumer Internet of Things: Baseline Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/Versioning.html">Versioning</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/bifravst">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://devzone.nordicsemi.com/search?q=bifravst#serpsort=date%20desc">DevZone</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adr/README.html">Architecture Decision Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../README.html">Bifravst</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../README.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Index.html">Cat Tracker firmware</a> &raquo;</li>
        
      <li>Device Data and Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/bifravst/bifravst/blob/saga/docs/firmware/SensorDataAndConfiguration.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="device-data-and-configuration">
<h1>Device Data and Configuration<a class="headerlink" href="#device-data-and-configuration" title="Permalink to this headline">¶</a></h1>
<p>The data published by the device and the configuration options are described in detail in the state JSON schema file for <a class="reference external" href="./state.reported.aws.schema.json">AWS</a>, and <a class="reference external" href="./state.reported.schema.azure.json">Azure</a>.
See <a class="reference external" href="./state.reported.aws.json">this state JSON document for an AWS example</a>, and <a class="reference external" href="./state.reported.azure.json">this state JSON document for an Azure example</a>.</p>
<p>Sending and receiving this data is different per cloud-operator, see implementation details for <a class="reference internal" href="../aws/IoTShadowAndTopics.html#aws-iot-shadow-topics"><span class="std std-ref">AWS here</span></a> .</p>
<div class="section" id="state-vs-messages">
<h2>State vs Messages<a class="headerlink" href="#state-vs-messages" title="Permalink to this headline">¶</a></h2>
<p>Most data is stored in the digital twin of the device, this is useful to be able to quickly query the last known data from the device.
However some data does not fit well into this model, e.g. because of its ephemeral nature.
In the Cat Tracker example we send the button pushes as a message and do not store it in the digital twin; after all it is a UI element and it in case of push buttons has no <em>state</em> which could be restored on the device or persists over a longer time.</p>
<p>The messages published by the device are described in detail in <a class="reference external" href="./messages.schema.json">the messages JSON schema file</a>.
See <a class="reference external" href="./message.json">this messages JSON document example</a> for an example device state.</p>
</div>
<div class="section" id="batch-data">
<h2>Batch data<a class="headerlink" href="#batch-data" title="Permalink to this headline">¶</a></h2>
<p>The firmware may send data as batch, using the schema described <a class="reference external" href="./batch.schema.json">in this JSON schema file</a>.
See <a class="reference external" href="./batch-message.json">this JSON document</a> for an example batch message.</p>
<p>For sending batched data from the device, the topic <code class="docutils literal notranslate"><span class="pre">&lt;deviceId&gt;/batch</span></code> is used.</p>
</div>
<div class="section" id="tracking-modes">
<h2>Tracking Modes<a class="headerlink" href="#tracking-modes" title="Permalink to this headline">¶</a></h2>
<p>The firmware implements two tracking modes: <em>passive</em> and <em>active</em>.</p>
<div class="section" id="passive-mode">
<h3>Passive Mode<a class="headerlink" href="#passive-mode" title="Permalink to this headline">¶</a></h3>
<p>This is the default mode.</p>
<p>In passive mode the device publishes data based on movement: if it registers movement on the accelerometer, it will publish data.
It will wait the amount of seconds configured in <code class="docutils literal notranslate"><span class="pre">cfg.mvres</span></code> before publishing the next time.</p>
<p>If it detects no movement for the amount of seconds specified in <code class="docutils literal notranslate"><span class="pre">cfg.mvt</span></code>, it will also publish data once.</p>
<p>The <a class="reference external" href="https://www.nordicsemi.com/Software-and-tools/Development-Kits/nRF9160-DK">nRF9160 DK (PCA10090)</a> does not support <em>passive</em> mode by default.
The <em>passive</em> mode depends on an external accelerometer (Analog Devices ADXL362) being connected to the GPIO ports specified in the <code class="docutils literal notranslate"><span class="pre">nrf9160_pca10090ns.overlay</span></code> file.</p>
</div>
<div class="section" id="active-mode">
<h3>Active Mode<a class="headerlink" href="#active-mode" title="Permalink to this headline">¶</a></h3>
<p>In active mode the device publishes data based on elapsed time.
It will wait the amount of seconds configured in <code class="docutils literal notranslate"><span class="pre">cfg.actwt</span></code> before publishing the next time.</p>
<p>The device can be put in <em>active</em> mode by setting the <code class="docutils literal notranslate"><span class="pre">cfg.act</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</div>
</div>
<div class="section" id="gps-timeout-configuration">
<h2>GPS Timeout configuration<a class="headerlink" href="#gps-timeout-configuration" title="Permalink to this headline">¶</a></h2>
<p>Since the <a class="reference external" href="https://github.com/bifravst/firmware/issues/8">firware currently does not support A-GPS</a> depending on the device location acquiring a GPS fix can take a long time.
Therefore a timeout of at least 1000 seconds should be chosen.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="LEDSchema.html" class="btn btn-neutral float-right" title="LED schema" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Protocol.html" class="btn btn-neutral float-left" title="Device-Cloud-Protocol" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2021, Nordic Semiconductor ASA | nordicsemi.no.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>